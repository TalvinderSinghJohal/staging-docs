---
title: Tool/Function Calling
description: The AI Gateway's Tool/Function Calling feature enables AI models to interact with external systems, APIs, databases, and custom business logic through a secure, enterprise-grade interface. This capability transforms AI from simple text generation to powerful workflow automation, allowing models to perform real-world actions while maintaining complete audit trails, security controls, and monitoring across all 7 supported AI providers.
sidebarTitle: Tool/Function Calling
---

## Overview

Tool/Function Calling represents a transformative capability that extends AI models beyond text generation to active interaction with external systems. By providing a unified, secure interface for tool integration, the AI Gateway enables organizations to build sophisticated AI agents that can access databases, call APIs, execute business logic, and orchestrate complex workflows while maintaining enterprise-grade security and observability.

### Key Capabilities

<Columns cols={2}>
  <Card title="Universal Tool Support" icon="globe">
    Consistent interface across all 7 AI providers.
  </Card>
  <Card title="OpenAI-Compatible Format" icon="code">
    Industry-standard tool definition format.
  </Card>
  <Card title="Provider Transformation" icon="refresh-cw">
    Automatic conversion between provider-specific formats.
  </Card>
  <Card title="Streaming Tool Calls" icon="zap">
    Real-time tool execution with streaming responses.
  </Card>
  <Card title="Security Framework" icon="shield">
    Enterprise-grade access controls and validation.
  </Card>
  <Card title="Audit Trail" icon="file-text">
    Complete logging of all tool calls and responses.
  </Card>
  <Card title="Parallel Execution" icon="layers">
    Concurrent tool calls where supported by providers.
  </Card>
</Columns>

### What Makes It Powerful

| Traditional AI | AI with Tool Calling |
|----------------|---------------------|
| Text-only responses | Real-world actions |
| Static information | Live data access |
| Manual workflows | Automated processes |
| Isolated AI | Connected ecosystem |
| Limited context | Dynamic data integration |
| One-time interaction | Multi-step workflows |

---

## How Tool/Function Calling Works

### Tool Definition

Tools are defined using the OpenAI-standard format, providing a consistent interface regardless of the underlying AI provider.

#### Tool Schema Structure
```json
{
  "type": "function",
  "function": {
    "name": "get_weather",
    "description": "Get the current weather for a specific location",
    "parameters": {
      "type": "object",
      "properties": {
        "location": {
          "type": "string",
          "description": "The location to get weather for"
        },
        "unit": {
          "type": "string",
          "enum": ["celsius", "fahrenheit"],
          "description": "Temperature unit"
        }
      },
      "required": ["location"]
    }
  }
}
```

#### Tool Choice Options
- **`auto`**: Let the model decide when to use tools
- **`required`**: Force the model to use at least one tool
- **`none`**: Disable tool calling for this request
- **Specific tool**: Force usage of a particular tool

### Provider Transformation

The gateway's RequestTransformer automatically converts OpenAI-standard tool definitions into provider-specific formats, ensuring seamless compatibility.

#### Transformation Matrix

| Provider | Native Format | Transformation | Complexity | Features |
|----------|--------------|----------------|------------|----------|
| OpenAI | OpenAI Standard | Pass-through | None | Full |
| Azure OpenAI | OpenAI Standard | Pass-through | None | Full |
| Anthropic | Tool Spec | Format conversion | Moderate | No parallel calls |
| Bedrock | ToolSpec | Schema transformation | Complex | Model-dependent |
| Google | Function Declaration | Structure mapping | Moderate | Limited streaming |
| Vertex AI | Function Declaration | Structure mapping | Moderate | Limited streaming |

#### Example Transformations

##### For Anthropic
```javascript
// OpenAI Format → Anthropic Format
{
  "name": "get_weather",
  "description": "Get weather information",
  "input_schema": {
    "type": "object",
    "properties": { "location": {"type": "string"} },
    "required": ["location"]
  }
}
```

##### For Bedrock
```javascript
// OpenAI Format → Bedrock Format
{
  "toolSpec": {
    "name": "get_weather",
    "description": "Get weather information",
    "inputSchema": {
      "json": {
        "type": "object",
        "properties": { "location": {"type": "string"} }
      }
    }
  }
}
```

### Execution Flow

#### Complete Tool Calling Pipeline
```
1. Tool Definition
   ├── OpenAI Standard Format
   └── Validation & Security Checks
      ↓
2. Provider Transformation
   ├── Format Conversion
   ├── Schema Mapping
   └── Feature Adaptation
      ↓
3. AI Model Processing
   ├── Tool Selection
   ├── Parameter Generation
   └── Execution Decision
      ↓
4. Tool Call Response
   ├── Structured Output
   ├── Error Handling
   └── Security Validation
      ↓
5. External System Integration
   ├── API Calls
   ├── Database Queries
   └── Business Logic Execution
      ↓
6. Response Processing
   ├── Result Validation
   ├── Security Filtering
   └── Audit Logging
      ↓
7. Model Integration
   ├── Result Incorporation
   ├── Follow-up Processing
   └── Final Response Generation
```

---

## Business Benefits

### Workflow Automation

#### Process Automation
- **80% Reduction in Manual Tasks**: Automate repetitive business processes
- **Multi-Step Workflows**: Chain multiple tools for complex operations
- **Decision Making**: AI-driven process routing and optimization
- **Error Recovery**: Intelligent handling of failed operations

#### Example Automation Results
```
Customer Support Workflow:
- Manual Process: 45 minutes average resolution
- AI + Tools: 3 minutes average resolution
- Efficiency Gain: 15x faster processing
- Cost Savings: $450,000 annually per 100 cases/day

Sales Process Automation:
- Lead qualification: 90% automated
- CRM updates: 100% automated
- Follow-up scheduling: 100% automated
- Revenue Impact: 35% increase in sales team productivity
```

### Data Integration

#### Real-Time Data Access
- **Live Database Queries**: Access current business data during conversations
- **API Integration**: Connect to any REST API or web service
- **System Orchestration**: Coordinate multiple backend systems
- **Data Enrichment**: Enhance AI responses with real-time context

#### Integration Capabilities
```typescript
// Example Data Sources
interface DataSources {
  databases: ['PostgreSQL', 'MySQL', 'MongoDB', 'Redis'];
  apis: ['REST', 'GraphQL', 'gRPC', 'SOAP'];
  services: ['AWS', 'Azure', 'GCP', 'On-premises'];
  protocols: ['HTTP', 'HTTPS', 'WebSocket', 'TCP'];
}
```

### Operational Efficiency

#### Resource Optimization
- **50% Reduction in Development Time**: Pre-built tool integration patterns
- **90% Faster Debugging**: Complete audit trails and error tracking
- **24/7 Operations**: Automated responses to system events
- **Scalable Architecture**: Handle thousands of concurrent tool calls

#### Performance Metrics
| Metric | Without Tools | With Tools | Improvement |
|--------|---------------|------------|-------------|
| Response Accuracy | 75% | 95% | 27% increase |
| Task Completion | 60% | 90% | 50% increase |
| User Satisfaction | 7.2/10 | 9.1/10 | 26% increase |
| Operational Cost | $100k/month | $45k/month | 55% reduction |

### Competitive Advantage

#### Market Differentiation
- **AI-Native Applications**: Build products that seamlessly blend AI with business logic
- **Rapid Innovation**: Deploy new AI capabilities without provider lock-in
- **Enterprise Integration**: Connect AI to existing enterprise systems
- **Scalable Solutions**: Support growth from prototype to enterprise scale

#### Business Impact
- **40% Faster Time-to-Market**: Rapid AI application development
- **3x Higher User Engagement**: Interactive, actionable AI experiences
- **60% Lower Integration Costs**: Unified tool interface across providers
- **25% Increase in Customer Retention**: More valuable AI interactions

---

## Technical Architecture

### Tool Processing Pipeline

#### Request Processing
```typescript
class ToolProcessor {
  async processToolCall(
    toolCall: ToolCall,
    context: RequestContext
  ): Promise<ToolResponse> {
    // 1. Security validation
    await this.validateToolAccess(toolCall, context);
    
    // 2. Parameter validation
    const validatedParams = this.validateParameters(toolCall);
    
    // 3. Tool execution
    const result = await this.executeToolCall(toolCall, validatedParams);
    
    // 4. Response validation
    const validatedResult = this.validateResponse(result);
    
    // 5. Audit logging
    await this.logToolExecution(toolCall, result, context);
    
    return validatedResult;
  }
}
```

### Provider-Specific Implementation

#### OpenAI and Azure OpenAI
```json
{
  "tools": [
    {
      "type": "function",
      "function": {
        "name": "execute_query",
        "description": "Execute a database query",
        "parameters": {
          "type": "object",
          "properties": {
            "query": {"type": "string"},
            "database": {"type": "string"}
          }
        }
      }
    }
  ],
  "tool_choice": "auto"
}
```

#### Anthropic Format
```json
{
  "tools": [
    {
      "name": "execute_query",
      "description": "Execute a database query",
      "input_schema": {
        "type": "object",
        "properties": {
          "query": {"type": "string"},
          "database": {"type": "string"}
        }
      }
    }
  ],
  "tool_choice": {"type": "auto"}
}
```

### Security Framework

#### Multi-Layer Security
```typescript
interface SecurityFramework {
  authentication: {
    apiKeys: 'API key validation';
    oauth: 'OAuth 2.0 integration';
    jwt: 'JWT token validation';
  };
  authorization: {
    rbac: 'Role-based access control';
    policies: 'Fine-grained permissions';
    contexts: 'Request context validation';
  };
  validation: {
    input: 'Parameter sanitization';
    output: 'Response filtering';
    schemas: 'JSON schema validation';
  };
  monitoring: {
    logging: 'Complete audit trail';
    alerting: 'Anomaly detection';
    metrics: 'Performance tracking';
  };
}
```

---

## Provider Support Matrix

### Feature Comparison

| Feature | OpenAI | Azure OpenAI | Anthropic | Bedrock | Google | Vertex AI |
|---------|--------|-------------|-----------|---------|---------|-----------|
| **Tool Calls** | ✅ Full | ✅ Full | ✅ Full | ✅ Full | ✅ Full | ✅ Full |
| **Parallel Calls** | ✅ Yes | ✅ Yes | ❌ No | ❌ No | ✅ Yes | ✅ Yes |
| **Streaming** | ✅ Yes | ✅ Yes | ✅ Yes | ✅ Yes | ⚠️ Limited | ⚠️ Limited |
| **Tool Choice** | ✅ Full | ✅ Full | ⚠️ Limited | ⚠️ Limited | ✅ Full | ✅ Full |
| **Complex Schemas** | ✅ Yes | ✅ Yes | ✅ Yes | ⚠️ Basic | ✅ Yes | ✅ Yes |

### Implementation Details

#### Streaming Support
```typescript
interface StreamingCapabilities {
  openai: {
    streamingToolCalls: true,
    parallelStreaming: true,
    chunkByChunk: true
  };
  anthropic: {
    streamingToolCalls: true,
    parallelStreaming: false,
    chunkByChunk: true
  };
  bedrock: {
    streamingToolCalls: true,
    parallelStreaming: false,
    chunkByChunk: true
  };
}
```

---

## Use Cases

### Enterprise Applications

#### Customer Service Automation
- **Scenario**: AI agent handling support tickets
- **Tools Used**: CRM lookup, ticket creation, knowledge base search
- **Impact**: 70% reduction in response time, 85% first-contact resolution
- **ROI**: $2.5M annual savings

**Example Tools**:
```json
{
  "tools": [
    {
      "type": "function",
      "function": {
        "name": "lookup_customer",
        "description": "Get customer information from CRM"
      }
    },
    {
      "type": "function", 
      "function": {
        "name": "create_ticket",
        "description": "Create support ticket"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "search_knowledge_base",
        "description": "Search internal documentation"
      }
    }
  ]
}
```

#### Financial Analysis Platform
- **Scenario**: AI-powered financial advisor
- **Tools Used**: Market data APIs, portfolio analysis, risk calculation
- **Impact**: 60% faster analysis, 40% better investment outcomes
- **ROI**: 15% portfolio performance improvement

#### Sales Intelligence System
- **Scenario**: AI sales assistant for lead qualification
- **Tools Used**: LinkedIn API, company database, email automation
- **Impact**: 3x lead qualification speed, 45% higher conversion
- **ROI**: $1.8M additional revenue

#### IT Operations Automation
- **Scenario**: AI-driven incident response
- **Tools Used**: Monitoring APIs, deployment tools, notification systems
- **Impact**: 90% faster incident resolution, 50% fewer escalations
- **ROI**: $3.2M in prevented downtime costs

### Industry Scenarios

#### Healthcare
- **Electronic Health Records**: Patient data lookup and updates
- **Drug Interaction Checking**: Real-time medication safety validation
- **Appointment Scheduling**: Integration with hospital systems
- **Lab Results**: Automated results interpretation and reporting

#### E-commerce
- **Inventory Management**: Real-time stock level checking
- **Price Optimization**: Dynamic pricing based on market data
- **Order Processing**: Automated order fulfillment workflows
- **Customer Analytics**: Behavioral data analysis and recommendations

#### Manufacturing
- **Equipment Monitoring**: IoT sensor data integration
- **Predictive Maintenance**: Machine learning model integration
- **Supply Chain**: Vendor and logistics system coordination
- **Quality Control**: Automated inspection result processing

#### Financial Services
- **Fraud Detection**: Real-time transaction analysis
- **Credit Scoring**: Dynamic risk assessment
- **Regulatory Compliance**: Automated compliance checking
- **Portfolio Management**: Investment strategy optimization

---

## Security and Compliance

### Access Control

#### Role-Based Permissions
```typescript
interface ToolPermissions {
  roles: {
    admin: ['*'];
    analyst: ['database.read', 'api.external'];
    user: ['search', 'basic_info'];
  };
  tools: {
    'sensitive_data': {
      requiredRoles: ['admin', 'analyst'];
      auditLevel: 'high';
      encryption: true;
    };
    'public_api': {
      requiredRoles: ['user', 'analyst', 'admin'];
      auditLevel: 'standard';
      rateLimit: '100/minute';
    };
  };
}
```

### Audit and Monitoring

#### Complete Tool Call Audit Trail
```typescript
interface ToolAuditLog {
  timestamp: string;
  requestId: string;
  userId: string;
  toolName: string;
  parameters: Record<string, any>;
  result: any;
  executionTime: number;
  success: boolean;
  errors?: string[];
  securityContext: {
    ipAddress: string;
    userAgent: string;
    authMethod: string;
  };
}
```

#### Security Monitoring
- **Real-time Alerting**: Suspicious tool usage patterns
- **Anomaly Detection**: Unusual parameter combinations
- **Access Violations**: Unauthorized tool access attempts
- **Performance Monitoring**: Tool execution performance tracking

### Compliance Features

#### Data Protection
- **PII Filtering**: Automatic detection and redaction of sensitive data
- **Encryption**: End-to-end encryption of tool parameters and responses
- **Data Residency**: Geographic restrictions on tool execution
- **Retention Policies**: Configurable audit log retention

#### Regulatory Compliance
- **SOC 2**: Security controls for tool execution
- **HIPAA**: Healthcare data protection compliance
- **GDPR**: Personal data handling compliance
- **PCI DSS**: Payment card industry compliance

---

## Best Practices

### Tool Design

#### Effective Tool Definition
```json
{
  "type": "function",
  "function": {
    "name": "descriptive_action_name",
    "description": "Clear, specific description of what the tool does and when to use it",
    "parameters": {
      "type": "object",
      "properties": {
        "param1": {
          "type": "string",
          "description": "Specific description with examples",
          "enum": ["value1", "value2"]
        }
      },
      "required": ["param1"]
    }
  }
}
```

#### Tool Naming Conventions
- **Verb-based names**: `get_weather`, `create_ticket`, `send_email`
- **Clear scope**: `database_query` not just `query`
- **Consistent prefixes**: `api_`, `db_`, `system_` for tool categories

### Error Handling

#### Robust Error Management
```typescript
interface ToolError {
  code: 'VALIDATION_ERROR' | 'EXECUTION_ERROR' | 'TIMEOUT' | 'PERMISSION_DENIED';
  message: string;
  details?: {
    field?: string;
    expected?: string;
    actual?: string;
  };
  retryable: boolean;
  suggestedAction?: string;
}
```

### Performance Optimization

#### Caching Strategies
- **Parameter-based caching**: Cache results for identical parameters
- **TTL-based expiration**: Appropriate cache durations per tool type
- **Cache invalidation**: Clear cache on data updates
- **Conditional caching**: Cache only expensive operations

#### Concurrent Execution
```typescript
// Parallel tool execution where supported
const toolResults = await Promise.all([
  executeToolCall(weatherTool),
  executeToolCall(calendarTool),
  executeToolCall(emailTool)
]);
```

---

## Advanced Features

### Multi-Step Workflows

#### Sequential Tool Execution
```typescript
interface WorkflowStep {
  toolName: string;
  parameters: Record<string, any>;
  dependsOn?: string[];
  condition?: (previousResults: any[]) => boolean;
}

interface Workflow {
  steps: WorkflowStep[];
  onError: 'stop' | 'continue' | 'retry';
  maxRetries: number;
}
```

### Dynamic Tool Discovery

#### Runtime Tool Registration
```typescript
class ToolRegistry {
  registerTool(tool: ToolDefinition): void;
  discoverTools(context: RequestContext): ToolDefinition[];
  validateToolAccess(toolName: string, context: RequestContext): boolean;
}
```

### Intelligent Tool Selection

#### Context-Aware Tool Recommendations
- **Usage Patterns**: Learn from successful tool combinations
- **Context Analysis**: Recommend tools based on conversation context
- **Performance Metrics**: Prioritize faster, more reliable tools
- **User Preferences**: Adapt to individual user patterns

---

## Troubleshooting

### Common Issues

#### Tool Call Failures
- **Invalid Parameters**: Ensure parameter types match schema
- **Missing Permissions**: Verify user has access to requested tools
- **Timeout Issues**: Check tool execution time limits
- **Schema Validation**: Validate JSON schema correctness

#### Provider-Specific Issues

##### Anthropic Limitations
- **No Parallel Calls**: Execute tools sequentially
- **Tool Choice Constraints**: Limited to auto/any/specific
- **Format Requirements**: Strict input_schema format

##### Bedrock Considerations
- **Model Dependencies**: Tool support varies by model
- **Complex Schemas**: May require schema simplification
- **Regional Availability**: Check tool support by AWS region

### Debugging Tools

#### Tool Execution Monitoring
```bash
# Monitor tool execution
curl http://gateway/admin/tools/stats

# Debug specific tool
curl http://gateway/admin/tools/{tool_name}/debug

# View tool call history
curl http://gateway/admin/tools/history?user_id=123
```

#### Performance Analysis
```typescript
// Tool performance metrics
interface ToolMetrics {
  averageExecutionTime: number;
  successRate: number;
  errorRate: number;
  mostCommonErrors: string[];
  usageFrequency: number;
}
```